در این بخش از دوره آموزشی SEC542 از موسسه SANS به آشنایی با جمع آوری اطلاعات در موتورهای جست و جو می پردازیم.
Information Gathering

جمع آوری اطلاعات یکی از مهمترین بخش های تست نفوذ می باشد که در آن شما می توانید با کسب هرچه بیشتر اطلاعات از سیستم هدف به آن نزدیکتر شوید. شما می توانید این کار را به صورت غیرفعال یا Passive انجام دهید که اطلاعاتی از شما بر روی سرور هدف ثبت نشود.

جست و جو در دیتابیس های whois، کسب اطلاعات DNS از وب سایت های موجود و همچنین استفاده از موتورهای جست و جو مواردی است که به صورت Passive انجام می شود. علاوه بر این گروه های خبری نیز می توانند منبع خوبی برای کسب اطلاعات در مورد هدف باشند، زیرا بسیاری از مدیران و به این گروه ها مراجعه نموده و یا بدون اینکه به ارزش اطلاعات خود توجه داشته باشند در آن ها پست های خود را قرار می دهند.

شبکه های اجتماعی گزینه دیگری خواهد بود که از آن می توان برای کسب اطلاعات شخصی و خصوصیات رفتاری افراد استفاده نموده و همچنین حملات دیگری مانند ارسال فایل مخرب با مهندسی اجتماعی را در این شبکه ها ترتیب داد.

موتورهای جست و جو نیز با توجه به ماهیت Web Crawler که در آن ها وجود دارد می توانند اطلاعات مفیدی را در مورد هدف در اختیار ما قرار دهند که در ادامه به آن ها خواهیم پرداخت.
Search Engines

بدون هیچ شکی، محبوب ترین موتور جست و جو بین کاربران اینترنتی، موتور جست و جوی گوگل می باشد. البته این موتور جست و جو در بین تست نفوذگران هم جایگاه ویژه ای دارد و آن ها با استفاده از ویژگی های گوگل اقدام به جست و جو در آن و کسب اطلاعات مورد نظر خود می نمایند که به این کار اصطلاحا Google Hacking گفته می شود.

البته توجه داشته باشید که فرآیند Google Hacking تنها به گوگل محدود نمی شود. در این مرحله از موتورهای جست و جوی دیگر هم استفاده می شود که برخی از آن ها نسبت به گوگل دارای مزایای متفاوتی هستند. از آن جا که گوگل برای شناسایی محتوای فنی بسیار مفید می باشد، متخصصان فناوری اطلاعات میل بیشتری به استفاده از گوگل دارند. با این حال مفاهیم مربوط به Google Hacking کلیه موتورهای جست و جو را در بر می گیرد.

موتورهای جست و جو دستورالعمل های جست و جوی پیشرفته را نیز ارائه می دهد که امکان محدودسازی نتایج جست و جو را برای کاربران فراهم می کند. از این دستورالعمل ها برای تست نفوذ و تجزیه و تحلیل اطلاعات نیز استفاده می شود.

برخی از عملگرهای موجود در گوگل عبارتند از:

Site: این عملگر به کاربر اجازه می دهد تا نتایج را تنها به یک سایت محدود نماید.
Inurl: این عملگر یک عبارت خاص را در URL سایت ها جست و جو می نماید.
Intitle: این عملگر به کاربر اجازه می دهد تا عبارت خاصی را در title سایت ها جست و جو نماید. به عنوان مثال زمانی که قابلیت Indexing در سرور فعال باشد، عبارت Index of در Tilte سایت وجود دارد که با جست و جوی این عبارت می توان به سایت های با قابلیت مذکور دست یافت.
Link: با این عملگر می توان سایت هایی که به هدف مورد نظر ما لینک داده اند را شناسایی نماییم.
Ext: این عملگر به شما اجازه می دهد تا پسوندهای مختلفی مانند doc، xls، ppt، pdf و غیره را جست و جو نمایید.

موارد زیر چگونگی استفاده از این عملگرها را نشان می دهد:

site:www.sans.org
inurl:phpinfo
intitle:”Admin Login”
link:sans.org
ext:xls

علاوه بر موتور جست و جوی گوگل شما می توانید برخی ازعملگرها را در موتور جست و جوی Bing هم استفاده نمایید:

site:www.sans.org
inanchor:phpinfo
intitle:”Admin Login”
filetype:xls
IP:55.66.77.88

علاوه بر موارد مذکور، هنگام جست و جو، گوگل اغلب نتایج زیادی را به ما نمایش می دهد که باید آن ها را یک به یک ارزیابی کنیم. البته خوشبختانه گوگل شامل اصلاح کننده هایی هم هست که برای محدود نمودن جست و جو ها از آن استفاده می شود.

یکی از این اصلاح کننده ها عملگر نقل قول می باشد (مانند “search keywords”) که برای جست و جوی رشته کلمات از آن استفاده می شود. همچنین عملگر منها یا (-) هم برای حذف کلمه یا عبارت مورد نظر از نتایج جست و جو مورد استفاده قرار می گیرد. البته باید در استفاده از این عملگرها احتیاط کنید زیرا ممکن است برخی از صفحاتی که برای شما جذاب و مفید باشند را به شما نمایش ندهند.

عملگر بعدی ستاره است که با استفاده از آن شما می توانید مجموعه از یک کلید واژه خاص را جست و جو نمایید.

مثال هایی در خصوص موارد مذکور عبارتند از:

“SANS Web Application”
site:sans.org -site:www.sans.org
site:sans.org -handlers
GHDB

Google Hacking Database یک منبع برای کوئری های گوگل می باشد که به وسیله آن می توان اطلاعات جالبی در مورد هدف به دست آورد. در اصطلاح به این کوئری ها Google Dorks گفته می شود. این کوئری ها شامل جست وجو هایی برای آسیب پذیری مربوط به برنامه، فایل ها حاوی کلمات عبور، صفحات خطا و موارد مشابه می باشد. برای دسترسی به این دیتابیس به لینک زیر مراجعه نمایید:

https://www.exploit-db.com/google-hacking-database
Automating Google Searches

چرا ما ابزارهای اسکریپتی که جست و جو ها را به صورت خودکار انجام می دهند و مورد علاقه تست نفوذگران هستند را ایجاد نمی کنیم؟

این یک ایده بسیار مفید است و برخی از افراد ابزارهای قدرتمندی را برای این کار ایجاد نموده اند که در اصل از Google Simple Object Access Protocol API و کلید API استفاده می کنند. متاسفانه، عملکرد SOAP گوگل نبوده و گوگل دیگر کلید های لازم را برای استفاده از این API فراهم نمی کند.

در همین راستا، گروه امنیتی SensePost ابزاری با نام Aura را منتشر کرد. Aura رابطی را فراهم می کند که درخواست های SOAP را به عبارت جستجوی استاندارد تبدیل نموده و نتایج را باز می گرداند. این ابزار به جای انجام این کار از طریق API گوگل که نیازمند کلید API گوگل می باشد، از Screen-Scraping برای جمع آوری اطلاعات استفاده نموده و اطلاعات را اصطلاحا Parse می نماید و نتایج را باز می گرداند. این قابلیت به طور موثراجازه می دهد برنامه های مبتنی بر SOAP API گوگل بدون نیاز به کلید API گوگل عمل نمایند.

متاسفانه روش Screen-Scraping که توسط Aura برای جمع آوری نتایج جست و جوی گوگل استفاده می شود، تخلف از شرایط سرویس گوگل است. با توجه به شرایط سرویس، گوگل حق دارد که در صورت نقص شرایط، از جست و جوی کاربران جلوگیری به عمل آورد. جهت دانلود این ابزار به لینک زیر مراجعه نمایید:

https://github.com/sensepost/SpUD
Network Social

خواندن صفحات شبکه های اجتماعی شخصی، اغلب مانند خواندن خاطرات مجازی است. تمام اطلاعات شخصی را می توان در این صفحات مشاهده و استخراج نمود که این اطلاعات می توانند در حملات مختلفی مانند مهندسی اجتماعی، حدث زدن کلمات عبور و یا حدث کلمات مربوط به reset Password استفاده شوند. رسانه هایی مانند Facebook، Linked in، Google+، Twitter و Telegram نمونه هایی از این شبکه های اجتماعی برای جمع آوری اطلاعات می باشند.
